2025-08-28T17:03:50.218759Z INFO     vrl_testing_loop_clean:_setup_logging:152 - VRL Testing Pipeline logging initialized
2025-08-28T17:03:50.219050Z INFO     vrl_testing_loop_clean:_setup_logging:153 - Log file: logs/vrl_pipeline_20250828_170350.log
2025-08-28T17:03:50.219193Z INFO     vrl_testing_loop_clean:_setup_logging:154 - Sample file: samples/fortinet-fortigate.ndjson
2025-08-28T17:03:50.219318Z INFO     vrl_testing_loop_clean:_setup_logging:155 - Output directory: samples-parsed
2025-08-28T17:03:50.219440Z INFO     vrl_testing_loop_clean:_setup_logging:156 - External configs: external
2025-08-28T17:03:50.219555Z INFO     vrl_testing_loop_clean:_setup_logging:157 - Loaded configs: ['vector_vrl_prompt', 'parser_prompts', 'type_maps']
2025-08-28T17:03:50.221190Z INFO     vrl_testing_loop_clean:__init__:113 - Benchmarking local CPU performance...
2025-08-28T17:03:50.226072Z INFO     vrl_testing_loop_clean:__init__:115 - CPU benchmark multiplier: 10.00x
2025-08-28T17:03:50.226236Z INFO     vrl_testing_loop_clean:__init__:118 - Measuring Vector CLI startup time...
2025-08-28T17:03:50.730541Z INFO     vrl_testing_loop_clean:__init__:120 - Vector startup time: 0.50s
2025-08-28T17:03:50.730780Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1067 - üìã EXTERNAL CONFIGS SUMMARY (K8s deployed):
2025-08-28T17:03:50.730999Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1074 -    üéØ vector-vrl-system.md: v1.3.0...
2025-08-28T17:03:50.731099Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1075 -       Contains: Performance tiers, string ops, Vector 0.49.0 config
2025-08-28T17:03:50.731163Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1079 -    üîß parser-system-prompts.md: 10690 chars of project overrides
2025-08-28T17:03:50.731237Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1085 -    üìä type_maps.csv: 24 field mappings for product evolution
2025-08-28T17:03:50.731286Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1087 -    üí° These configs are retained for persistent LLM context
2025-08-28T17:03:51.399482Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1201 - ü§ñ Starting automated LLM VRL generation
2025-08-28T17:03:51.399640Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1202 - Provider: anthropic, Max iterations: 2
2025-08-28T17:03:51.430942Z INFO     llm_iterative_session:_init_anthropic:433 - üîç Auto-detecting latest Anthropic model...
2025-08-28T17:03:51.431102Z INFO     llm_iterative_session:_detect_best_anthropic_model:140 - üîç Querying Anthropic API for available models...
2025-08-28T17:03:51.739599Z INFO     llm_iterative_session:_detect_best_anthropic_model:166 - Available Anthropic models: ['claude-opus-4-1-20250805', 'claude-opus-4-20250514', 'claude-sonnet-4-20250514', 'claude-3-7-sonnet-20250219', 'claude-3-5-sonnet-20241022']...
2025-08-28T17:03:51.739781Z INFO     llm_iterative_session:_detect_best_anthropic_model:187 - ‚úÖ Selected best Opus model: claude-opus-4-1-20250805
2025-08-28T17:03:51.740727Z INFO     llm_iterative_session:_init_anthropic:435 - üéØ Selected model: claude-opus-4-1-20250805
2025-08-28T17:03:52.087945Z INFO     llm_iterative_session:__init__:124 - ü§ñ Iterative LLM Session initialized
2025-08-28T17:03:52.088382Z INFO     llm_iterative_session:__init__:125 -    Provider: anthropic
2025-08-28T17:03:52.088447Z INFO     llm_iterative_session:__init__:126 -    Model: claude-opus-4-1-20250805
2025-08-28T17:03:52.088488Z INFO     llm_iterative_session:__init__:127 -    Session: llm_session_20250828_170351
2025-08-28T17:03:52.088524Z INFO     llm_iterative_session:__init__:131 - üìä Model Capabilities:
2025-08-28T17:03:52.088575Z INFO     llm_iterative_session:__init__:132 -    Context Window: 200,000 tokens
2025-08-28T17:03:52.088644Z INFO     llm_iterative_session:__init__:133 -    Max Input: 200,000 tokens
2025-08-28T17:03:52.088687Z INFO     llm_iterative_session:__init__:134 -    Max Output: 4,096 tokens
2025-08-28T17:03:52.088731Z INFO     llm_iterative_session:__init__:136 -    Cost: $0.000015/input, $0.000075/output per token
2025-08-28T17:03:52.088782Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1210 - üí∞ Cost tracking: $0.000015/input token, $0.000075/output token
2025-08-28T17:03:52.088858Z INFO     llm_iterative_session:generate_initial_vrl:679 - üöÄ Starting VRL generation session (iteration 1)
2025-08-28T17:03:52.089423Z DEBUG    llm_iterative_session:_save_conversation:1230 - üíæ Saved user message to .tmp/llm_sessions/llm_session_20250828_170351/iter1_user.txt
2025-08-28T17:03:52.089500Z INFO     llm_iterative_session:_call_llm:955 - üì§ Calling anthropic API
2025-08-28T17:03:52.089558Z DEBUG    llm_iterative_session:_call_llm:956 -    Prompt length: 42267 chars
2025-08-28T17:03:54.045233Z DEBUG    llm_iterative_session:_call_anthropic:1101 - Model claude-opus-4-1-20250805 failed: Error code: 500 - {'type': 'error', 'error': {'type': 'api_error', 'message': 'Overloaded'}, 'request_id': None}
2025-08-28T17:04:58.789590Z WARNING  llm_iterative_session:_call_anthropic:1089 - Fell back from claude-opus-4-1-20250805 to claude-opus-4-20250514
2025-08-28T17:04:58.789762Z INFO     llm_iterative_session:_call_llm:971 - üì• Response received in 66.7s (9255 chars)
2025-08-28T17:04:58.790472Z DEBUG    llm_iterative_session:_save_conversation:1230 - üíæ Saved assistant message to .tmp/llm_sessions/llm_session_20250828_170351/iter1_assistant.txt
2025-08-28T17:04:58.790543Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1224 - Testing iteration 1
2025-08-28T17:04:58.790747Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T17:04:58.790905Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - TESTING LLM-GENERATED VRL (Iteration 1)
2025-08-28T17:04:58.791065Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T17:04:58.791219Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - 
1. TESTING WITH PyVRL
2025-08-28T17:04:58.791358Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ----------------------------------------
2025-08-28T17:04:58.796007Z ERROR    vrl_testing_loop_clean:test_with_pyvrl:311 - ‚úó PyVRL validation failed: 
error[E103]: unhandled fallible assignment
    ‚îå‚îÄ :102:20
    ‚îÇ
102 ‚îÇ         type_end = split(type_value, " ")
    ‚îÇ         ---------- ^^^^^^^^^^^^^^^^^^^^^^
    ‚îÇ         ‚îÇ          ‚îÇ
    ‚îÇ         ‚îÇ          this expression is fallible because at least one argument's type cannot be verified to be valid
    ‚îÇ         ‚îÇ          update the expression to be infallible by adding a `!`: `split!(type_value, " ")`
    ‚îÇ         ‚îÇ          `type_value` argument type is `string or null` and this function expected a parameter `value` of type `string`
    ‚îÇ         or change this to an infallible assignment:
    ‚îÇ         type_end, err = split(type_value, " ")
    ‚îÇ
    = see documentation about error handling at https://errors.vrl.dev/#handling
    = see functions characteristics documentation at https://vrl.dev/expressions/#function-call-characteristics
    = learn more about error code 103 at https://errors.vrl.dev/103
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

2025-08-28T17:04:58.796099Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ‚ùå LLM VRL iteration 1 failed PyVRL validation
2025-08-28T17:04:58.796162Z INFO     llm_iterative_session:iterate_with_feedback:713 - üîÑ Iterating VRL generation (iteration 2)
2025-08-28T17:04:58.796393Z DEBUG    llm_iterative_session:_save_conversation:1230 - üíæ Saved user message to .tmp/llm_sessions/llm_session_20250828_170351/iter2_user.txt
2025-08-28T17:04:58.796448Z DEBUG    llm_iterative_session:_call_llm:952 - Adding 1.4s delay for iteration 2 to avoid rate limits
2025-08-28T17:05:00.196594Z INFO     llm_iterative_session:_call_llm:955 - üì§ Calling anthropic API
2025-08-28T17:05:00.197397Z DEBUG    llm_iterative_session:_call_llm:956 -    Prompt length: 829 chars
2025-08-28T17:06:05.197979Z INFO     llm_iterative_session:_call_llm:971 - üì• Response received in 65.0s (10181 chars)
2025-08-28T17:06:05.198397Z DEBUG    llm_iterative_session:_save_conversation:1230 - üíæ Saved assistant message to .tmp/llm_sessions/llm_session_20250828_170351/iter2_assistant.txt
2025-08-28T17:06:05.198474Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1224 - Testing iteration 2
2025-08-28T17:06:05.198526Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T17:06:05.198568Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - TESTING LLM-GENERATED VRL (Iteration 2)
2025-08-28T17:06:05.198604Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T17:06:05.198643Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - 
1. TESTING WITH PyVRL
2025-08-28T17:06:05.198679Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ----------------------------------------
2025-08-28T17:06:05.210772Z ERROR    vrl_testing_loop_clean:test_with_pyvrl:311 - ‚úó PyVRL validation failed: 
error[E103]: unhandled fallible assignment
    ‚îå‚îÄ :126:20
    ‚îÇ
126 ‚îÇ         type_end = split(type_value, " ")
    ‚îÇ         ---------- ^^^^^^^^^^^^^^^^^^^^^^
    ‚îÇ         ‚îÇ          ‚îÇ
    ‚îÇ         ‚îÇ          this expression is fallible because at least one argument's type cannot be verified to be valid
    ‚îÇ         ‚îÇ          update the expression to be infallible by adding a `!`: `split!(type_value, " ")`
    ‚îÇ         ‚îÇ          `type_value` argument type is `string or null` and this function expected a parameter `value` of type `string`
    ‚îÇ         or change this to an infallible assignment:
    ‚îÇ         type_end, err = split(type_value, " ")
    ‚îÇ
    = see documentation about error handling at https://errors.vrl.dev/#handling
    = see functions characteristics documentation at https://vrl.dev/expressions/#function-call-characteristics
    = learn more about error code 103 at https://errors.vrl.dev/103
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

2025-08-28T17:06:05.211388Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ‚ùå LLM VRL iteration 2 failed PyVRL validation
2025-08-28T17:06:05.211744Z WARNING  vrl_testing_loop_clean:run_automated_llm_generation:1266 - Failed to generate valid VRL after 2 iterations
2025-08-28T17:06:05.212019Z INFO     llm_iterative_session:log_cost_summary:1339 - üí∞ SESSION COST SUMMARY:
2025-08-28T17:06:05.212121Z INFO     llm_iterative_session:log_cost_summary:1340 -    Estimated cost: $0.5259
2025-08-28T17:06:05.212277Z INFO     llm_iterative_session:log_cost_summary:1341 -    Total tokens: ~15,631
2025-08-28T17:06:05.212336Z INFO     llm_iterative_session:log_cost_summary:1342 -    Iterations: 2
2025-08-28T17:06:05.212378Z INFO     llm_iterative_session:log_cost_summary:1343 -    Model: claude-opus-4-20250514
2025-08-28T17:06:05.212439Z WARNING  llm_iterative_session:log_cost_summary:1347 -    ‚ÑπÔ∏è  Anthropic doesn't provide a public credits API. Check console.anthropic.com for actual balance.
