2025-08-28T19:08:54.386421Z INFO     vrl_testing_loop_clean:_setup_logging:152 - VRL Testing Pipeline logging initialized
2025-08-28T19:08:54.386806Z INFO     vrl_testing_loop_clean:_setup_logging:153 - Log file: logs/vrl_pipeline_20250828_190854.log
2025-08-28T19:08:54.387015Z INFO     vrl_testing_loop_clean:_setup_logging:154 - Sample file: samples/large/ssh-real.ndjson
2025-08-28T19:08:54.387204Z INFO     vrl_testing_loop_clean:_setup_logging:155 - Output directory: samples-parsed
2025-08-28T19:08:54.387429Z INFO     vrl_testing_loop_clean:_setup_logging:156 - External configs: external
2025-08-28T19:08:54.387637Z INFO     vrl_testing_loop_clean:_setup_logging:157 - Loaded configs: ['vector_vrl_prompt', 'parser_prompts', 'type_maps']
2025-08-28T19:09:11.866352Z INFO     vrl_testing_loop_clean:__init__:113 - Benchmarking local CPU performance...
2025-08-28T19:09:11.870533Z INFO     vrl_testing_loop_clean:__init__:115 - CPU benchmark multiplier: 10.00x
2025-08-28T19:09:11.870659Z INFO     vrl_testing_loop_clean:__init__:118 - Measuring Vector CLI startup time...
2025-08-28T19:09:12.372572Z INFO     vrl_testing_loop_clean:__init__:120 - Vector startup time: 0.50s
2025-08-28T19:09:12.372768Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1067 - üìã EXTERNAL CONFIGS SUMMARY (K8s deployed):
2025-08-28T19:09:12.372899Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1074 -    üéØ vector-vrl-system.md: v1.3.0...
2025-08-28T19:09:12.372992Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1075 -       Contains: Performance tiers, string ops, Vector 0.49.0 config
2025-08-28T19:09:12.373037Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1079 -    üîß parser-system-prompts.md: 10690 chars of project overrides
2025-08-28T19:09:12.373089Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1085 -    üìä type_maps.csv: 24 field mappings for product evolution
2025-08-28T19:09:12.373131Z INFO     vrl_testing_loop_clean:_log_external_configs_summary:1087 -    üí° These configs are retained for persistent LLM context
2025-08-28T19:09:12.373187Z INFO     __main__:test_stream:42 - üöÄ Starting automated generation (max 5 iterations)
2025-08-28T19:09:12.373235Z INFO     __main__:test_stream:43 - Watch for:
2025-08-28T19:09:12.373271Z INFO     __main__:test_stream:44 -   - Pre-tokenizer: 655K ‚Üí 3 samples
2025-08-28T19:09:12.373317Z INFO     __main__:test_stream:45 -   - Model-specific fixes triggering
2025-08-28T19:09:12.373350Z INFO     __main__:test_stream:46 -   - E103 ‚Üí E620 ‚Üí SUCCESS progression
2025-08-28T19:09:13.009648Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1201 - ü§ñ Starting automated LLM VRL generation
2025-08-28T19:09:13.013059Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1202 - Provider: anthropic, Max iterations: 5
2025-08-28T19:09:13.032243Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1210 - üîß Optimizing samples with pre-tokenizer...
2025-08-28T19:09:13.557669Z INFO     pre_tokenizer.enhanced_optimizer:smart_sample_selection:132 - Found 1 distinct patterns in 655147 samples
2025-08-28T19:09:22.054530Z SUCCESS  pre_tokenizer.enhanced_optimizer:smart_sample_selection:172 - Selected 3 samples covering 1 patterns
2025-08-28T19:09:22.230964Z INFO     pre_tokenizer.pre_tokenizer:__init__:41 - Initialized PreTokenizer for claude-3-opus-20240229 with 30,000 max tokens
2025-08-28T19:09:22.231358Z INFO     pre_tokenizer.pre_tokenizer:optimize_samples:101 - Optimizing 3 samples for 30,000 tokens
2025-08-28T19:09:22.232059Z INFO     pre_tokenizer.pre_tokenizer:optimize_samples:116 - Reduced to 3 unique samples from 3
2025-08-28T19:09:22.232163Z INFO     pre_tokenizer.pre_tokenizer:optimize_samples:117 - Pattern distribution: {'auth': 1}
2025-08-28T19:09:22.234124Z SUCCESS  pre_tokenizer.pre_tokenizer:optimize_samples:190 - Selected 3 samples using 1,770 tokens
2025-08-28T19:09:22.234203Z INFO     pre_tokenizer.pre_tokenizer:optimize_samples:191 - Pattern coverage: 100.0%
2025-08-28T19:09:22.234258Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1241 - üìä Sample optimization: 655147 ‚Üí 3 samples
2025-08-28T19:09:22.234332Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1242 - üìä Token usage: 1,770 tokens
2025-08-28T19:09:22.234398Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1243 - üìä Pattern coverage: 100.0%
2025-08-28T19:09:22.270825Z INFO     llm_iterative_session:_init_anthropic:433 - üîç Auto-detecting latest Anthropic model...
2025-08-28T19:09:22.271195Z INFO     llm_iterative_session:_detect_best_anthropic_model:140 - üîç Querying Anthropic API for available models...
2025-08-28T19:09:22.583881Z INFO     llm_iterative_session:_detect_best_anthropic_model:166 - Available Anthropic models: ['claude-opus-4-1-20250805', 'claude-opus-4-20250514', 'claude-sonnet-4-20250514', 'claude-3-7-sonnet-20250219', 'claude-3-5-sonnet-20241022']...
2025-08-28T19:09:22.584113Z INFO     llm_iterative_session:_detect_best_anthropic_model:187 - ‚úÖ Selected best Opus model: claude-opus-4-1-20250805
2025-08-28T19:09:22.585794Z INFO     llm_iterative_session:_init_anthropic:435 - üéØ Selected model: claude-opus-4-1-20250805
2025-08-28T19:09:22.916901Z INFO     llm_iterative_session:__init__:124 - ü§ñ Iterative LLM Session initialized
2025-08-28T19:09:22.923373Z INFO     llm_iterative_session:__init__:125 -    Provider: anthropic
2025-08-28T19:09:22.923536Z INFO     llm_iterative_session:__init__:126 -    Model: claude-opus-4-1-20250805
2025-08-28T19:09:22.923596Z INFO     llm_iterative_session:__init__:127 -    Session: llm_session_20250828_190922
2025-08-28T19:09:22.923647Z INFO     llm_iterative_session:__init__:131 - üìä Model Capabilities:
2025-08-28T19:09:22.923708Z INFO     llm_iterative_session:__init__:132 -    Context Window: 200,000 tokens
2025-08-28T19:09:22.923762Z INFO     llm_iterative_session:__init__:133 -    Max Input: 200,000 tokens
2025-08-28T19:09:22.923813Z INFO     llm_iterative_session:__init__:134 -    Max Output: 4,096 tokens
2025-08-28T19:09:22.923869Z INFO     llm_iterative_session:__init__:136 -    Cost: $0.000015/input, $0.000075/output per token
2025-08-28T19:09:22.923944Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1249 - üí∞ Cost tracking: $0.000015/input token, $0.000075/output token
2025-08-28T19:09:22.924021Z INFO     llm_iterative_session:generate_initial_vrl:679 - üöÄ Starting VRL generation session (iteration 1)
2025-08-28T19:09:22.927439Z INFO     prompt_optimizer:_optimize_initial_configs:82 - Compressed vector_vrl_prompt: 20935 ‚Üí 18968 chars (9.4% reduction)
2025-08-28T19:09:22.927796Z INFO     prompt_optimizer:_optimize_initial_configs:101 - Compressed parser_prompts: 10690 ‚Üí 1988 chars (81.4% reduction)
2025-08-28T19:09:22.927898Z INFO     prompt_optimizer:_optimize_initial_configs:133 - Compressed type_maps: 2877 ‚Üí 2749 chars (4.4% reduction)
2025-08-28T19:09:22.928723Z DEBUG    llm_iterative_session:_save_conversation:1297 - üíæ Saved user message to .tmp/llm_sessions/llm_session_20250828_190922/iter1_user.txt
2025-08-28T19:09:22.928799Z INFO     llm_iterative_session:_call_llm:1022 - üì§ Calling anthropic API
2025-08-28T19:09:22.928852Z DEBUG    llm_iterative_session:_call_llm:1023 -    Prompt length: 31037 chars
2025-08-28T19:10:28.541564Z INFO     llm_iterative_session:_call_llm:1038 - üì• Response received in 65.6s (7693 chars)
2025-08-28T19:10:28.547118Z DEBUG    llm_iterative_session:_save_conversation:1297 - üíæ Saved assistant message to .tmp/llm_sessions/llm_session_20250828_190922/iter1_assistant.txt
2025-08-28T19:10:28.547226Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1263 - Testing iteration 1
2025-08-28T19:10:28.547316Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T19:10:28.547382Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - TESTING LLM-GENERATED VRL (Iteration 1)
2025-08-28T19:10:28.547443Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ============================================================
2025-08-28T19:10:28.547526Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - 
1. TESTING WITH PyVRL
2025-08-28T19:10:28.547597Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ----------------------------------------
2025-08-28T19:10:28.551891Z ERROR    vrl_testing_loop_clean:test_with_pyvrl:311 - ‚úó PyVRL validation failed: 
error[E110]: fallible predicate
   ‚îå‚îÄ :36:17
   ‚îÇ
36 ‚îÇ     if contains(sshd_content, "]: ") {
   ‚îÇ                 ^^^^^^^^^^^^
   ‚îÇ                 ‚îÇ
   ‚îÇ                 this expression resolves to one of string or null
   ‚îÇ                 but the parameter "value" expects the exact type string
   ‚îÇ
   = try: ensuring an appropriate type at runtime
   =
   =     sshd_content = string!(sshd_content)
   =     contains(sshd_content, "]: ")
   =
   = try: coercing to an appropriate type and specifying a default value as a fallback in case coercion fails
   =
   =     sshd_content = to_string(sshd_content) ?? "default"
   =     contains(sshd_content, "]: ")
   =
   = see documentation about error handling at https://errors.vrl.dev/#handling
   = learn more about error code 110 at https://errors.vrl.dev/110
   = see language documentation at https://vrl.dev
   = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E651]: unnecessary error coalescing operation
    ‚îå‚îÄ :183:22
    ‚îÇ
183 ‚îÇ   .ssh.source_port = to_int!(string!(.ssh.port)) ?? null
    ‚îÇ                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^ -- ---- this expression never resolves
    ‚îÇ                      ‚îÇ                           ‚îÇ
    ‚îÇ                      ‚îÇ                           remove this error coalescing operation
    ‚îÇ                      this expression can't fail
    ‚îÇ
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E620]: can't abort infallible function
    ‚îå‚îÄ :188:19
    ‚îÇ
188 ‚îÇ   .ssh.username = downcase!(string!(.ssh.username))
    ‚îÇ                   ^^^^^^^^- remove this abort-instruction
    ‚îÇ                   ‚îÇ
    ‚îÇ                   this function can't fail
    ‚îÇ
    = see documentation about error handling at https://errors.vrl.dev/#handling
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E620]: can't abort infallible function
    ‚îå‚îÄ :191:20
    ‚îÇ
191 ‚îÇ   .ssh.auth_type = downcase!(string!(.ssh.auth_type))
    ‚îÇ                    ^^^^^^^^- remove this abort-instruction
    ‚îÇ                    ‚îÇ
    ‚îÇ                    this function can't fail
    ‚îÇ
    = see documentation about error handling at https://errors.vrl.dev/#handling
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E620]: can't abort infallible function
    ‚îå‚îÄ :194:19
    ‚îÇ
194 ‚îÇ   .ssh.protocol = downcase!(string!(.ssh.protocol))
    ‚îÇ                   ^^^^^^^^- remove this abort-instruction
    ‚îÇ                   ‚îÇ
    ‚îÇ                   this function can't fail
    ‚îÇ
    = see documentation about error handling at https://errors.vrl.dev/#handling
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E105]: call to undefined function
    ‚îå‚îÄ :198:18
    ‚îÇ
198 ‚îÇ .ssh.source_ip = string_fast!(.ssh.source_ip) ?? null
    ‚îÇ                  ^^^^^^^^^^^
    ‚îÇ                  ‚îÇ
    ‚îÇ                  undefined function
    ‚îÇ                  did you mean "string"?
    ‚îÇ
    = learn more about error code 105 at https://errors.vrl.dev/105
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E651]: unnecessary error coalescing operation
    ‚îå‚îÄ :199:20
    ‚îÇ
199 ‚îÇ .ssh.source_host = string!(.ssh.source_host) ?? null
    ‚îÇ                    ^^^^^^^^^^^^^^^^^^^^^^^^^ -- ---- this expression never resolves
    ‚îÇ                    ‚îÇ                         ‚îÇ
    ‚îÇ                    ‚îÇ                         remove this error coalescing operation
    ‚îÇ                    this expression can't fail
    ‚îÇ
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E105]: call to undefined function
    ‚îå‚îÄ :201:20
    ‚îÇ
201 ‚îÇ .ssh.auth_result = string_low_cardinality!(.ssh.auth_result) ?? null
    ‚îÇ                    ^^^^^^^^^^^^^^^^^^^^^^
    ‚îÇ                    ‚îÇ
    ‚îÇ                    undefined function
    ‚îÇ                    did you mean "to_syslog_facility"?
    ‚îÇ
    = learn more about error code 105 at https://errors.vrl.dev/105
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E105]: call to undefined function
    ‚îå‚îÄ :203:23
    ‚îÇ
203 ‚îÇ .ssh.failure_reason = string_low_cardinality!(.ssh.failure_reason) ?? null
    ‚îÇ                       ^^^^^^^^^^^^^^^^^^^^^^
    ‚îÇ                       ‚îÇ
    ‚îÇ                       undefined function
    ‚îÇ                       did you mean "to_syslog_facility"?
    ‚îÇ
    = learn more about error code 105 at https://errors.vrl.dev/105
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E105]: call to undefined function
    ‚îå‚îÄ :204:19
    ‚îÇ
204 ‚îÇ .ssh.event_type = string_low_cardinality!(.ssh.event_type) ?? null
    ‚îÇ                   ^^^^^^^^^^^^^^^^^^^^^^
    ‚îÇ                   ‚îÇ
    ‚îÇ                   undefined function
    ‚îÇ                   did you mean "to_syslog_facility"?
    ‚îÇ
    = learn more about error code 105 at https://errors.vrl.dev/105
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E651]: unnecessary error coalescing operation
    ‚îå‚îÄ :206:12
    ‚îÇ
206 ‚îÇ .ssh.pid = string!(.ssh.pid) ?? null
    ‚îÇ            ^^^^^^^^^^^^^^^^^ -- ---- this expression never resolves
    ‚îÇ            ‚îÇ                 ‚îÇ
    ‚îÇ            ‚îÇ                 remove this error coalescing operation
    ‚îÇ            this expression can't fail
    ‚îÇ
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

error[E105]: call to undefined function
    ‚îå‚îÄ :207:12
    ‚îÇ
207 ‚îÇ .ssh.uid = int32!(.ssh.uid) ?? null
    ‚îÇ            ^^^^^
    ‚îÇ            ‚îÇ
    ‚îÇ            undefined function
    ‚îÇ            did you mean "int"?
    ‚îÇ
    = learn more about error code 105 at https://errors.vrl.dev/105
    = see language documentation at https://vrl.dev
    = try your code in the VRL REPL, learn more at https://vrl.dev/examples

2025-08-28T19:10:28.552763Z INFO     vrl_testing_loop_clean:_log_with_timestamp:1111 - ‚ùå LLM VRL iteration 1 failed PyVRL validation
2025-08-28T19:10:28.553742Z INFO     error_batch_collector:collect_all_errors:46 - üìã Phase 1: PyVRL syntax validation
2025-08-28T19:10:28.553887Z INFO     error_batch_collector:collect_all_errors:52 - üìã Phase 2: Vector CLI validation
2025-08-28T19:10:28.565556Z INFO     error_batch_collector:collect_all_errors:75 - üìä Collected 1 total errors
2025-08-28T19:10:28.567754Z INFO     error_batch_collector:collect_all_errors:79 -    other: 1 errors
2025-08-28T19:10:28.567871Z INFO     vrl_testing_loop_clean:run_automated_llm_generation:1347 - üìä Collected 1 errors for batch fixing
2025-08-28T19:10:28.567995Z INFO     llm_iterative_session:iterate_with_feedback:713 - üîÑ Iterating VRL generation (iteration 2)
2025-08-28T19:10:28.568389Z DEBUG    llm_iterative_session:_save_conversation:1297 - üíæ Saved user message to .tmp/llm_sessions/llm_session_20250828_190922/iter2_user.txt
2025-08-28T19:10:28.568478Z DEBUG    llm_iterative_session:_call_llm:1019 - Adding 1.4s delay for iteration 2 to avoid rate limits
2025-08-28T19:10:29.968676Z INFO     llm_iterative_session:_call_llm:1022 - üì§ Calling anthropic API
2025-08-28T19:10:29.969081Z DEBUG    llm_iterative_session:_call_llm:1023 -    Prompt length: 465 chars
